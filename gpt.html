<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>EXODUS FOOTBALL 26</title>
<style>
html,body{
  margin:0;
  padding:0;
  overflow:hidden;
  background:#000;
  font-family:Arial,Helvetica,sans-serif;
  color:white;
}
#hud{
  position:fixed;
  top:10px;
  left:10px;
  z-index:10;
  font-size:14px;
}
#playbook{
  position:fixed;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  border:2px solid purple;
  padding:12px;
  background:rgba(0,0,0,0.8);
  display:none;
}
#playbook h3{margin:0 0 6px 0;text-align:center;}
#crosshair{
  position:fixed;
  top:50%;
  left:50%;
  width:10px;
  height:10px;
  transform:translate(-50%,-50%);
  border:1px solid white;
}
</style>
</head>
<body>

<div id="hud">
<b>EXODUS FOOTBALL 26</b><br>
WASD Move | Mouse Look | SPACE Throw | ENTER Snap<br>
1 Slant | 2 Streak | 3 Out | 4 Post<br>
Down: <span id="down">1</span> &nbsp; Ball on: <span id="yard">25</span>
</div>

<div id="playbook">
<h3>PLAYBOOK</h3>
1 – Slant<br>
2 – Streak<br>
3 – Out<br>
4 – Post<br><br>
<b>Press ENTER to Snap</b>
</div>

<div id="crosshair"></div>

<script src="https://cdn.jsdelivr.net/npm/three@0.152/build/three.min.js"></script>

<script>
/* ===============================
   CORE GAME STATE
================================ */
let scene,camera,renderer,clock;
let state="PLAYCALL";
let keys={},mouse={x:0,y:0};
let down=1,ballYard=25;
let currentRoute=1;
let snapped=false;
let ball,ballVel=new THREE.Vector3();

/* ===============================
   INIT
================================ */
init();
animate();

function init(){
  scene=new THREE.Scene();
  scene.fog=new THREE.Fog(0x000000,400,1600);

  camera=new THREE.PerspectiveCamera(75,innerWidth/innerHeight,1,3000);
  camera.position.set(-600,180,0);

  renderer=new THREE.WebGLRenderer({antialias:true});
  renderer.setSize(innerWidth,innerHeight);
  document.body.appendChild(renderer.domElement);

  clock=new THREE.Clock();

  /* LIGHTING */
  scene.add(new THREE.AmbientLight(0xffffff,0.5));
  let sun=new THREE.DirectionalLight(0xffffff,0.8);
  sun.position.set(300,800,200);
  scene.add(sun);

  /* FIELD */
  let field=new THREE.Mesh(
    new THREE.PlaneGeometry(2000,800),
    new THREE.MeshStandardMaterial({color:0x1f8b4c})
  );
  field.rotation.x=-Math.PI/2;
  scene.add(field);

  /* ENDZONES */
  addEndzone(-1000,0x4b0082);
  addEndzone(1000,0x4b0082);

  /* YARD LINES */
  for(let i=-900;i<=900;i+=100){
    let line=new THREE.Mesh(
      new THREE.PlaneGeometry(4,800),
      new THREE.MeshBasicMaterial({color:0xffffff})
    );
    line.rotation.x=-Math.PI/2;
    line.position.x=i;
    scene.add(line);
  }

  /* PLAYERS */
  createPlayers();

  /* BALL */
  ball=new THREE.Mesh(
    new THREE.SphereGeometry(4,16,16),
    new THREE.MeshStandardMaterial({color:0x8b4513})
  );
  scene.add(ball);

  document.getElementById("playbook").style.display="block";

  /* EVENTS */
  addEventListener("resize",()=> {
    camera.aspect=innerWidth/innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(innerWidth,innerHeight);
  });

  document.addEventListener("keydown",e=>{
    keys[e.key.toLowerCase()]=true;
    if(e.key==="Enter" && state==="PLAYCALL"){
      snapBall();
    }
    if("1234".includes(e.key)) currentRoute=parseInt(e.key);
  });

  document.addEventListener("keyup",e=>keys[e.key.toLowerCase()]=false);

  document.body.addEventListener("click",()=>{
    document.body.requestPointerLock();
  });

  document.addEventListener("mousemove",e=>{
    if(document.pointerLockElement){
      mouse.x+=e.movementX*0.002;
      mouse.y+=e.movementY*0.002;
      mouse.y=Math.max(-1.2,Math.min(1.2,mouse.y));
    }
  });
}

/* ===============================
   PLAYERS
================================ */
let qb,receivers=[],defenders=[];

function createPlayers(){
  qb=box(0,5,0,0xcccccc);
  for(let i=0;i<3;i++){
    let wr=box(-20,5,-80+i*80,0x800080);
    receivers.push(wr);
  }
  for(let i=0;i<4;i++){
    let db=box(60,5,-120+i*80,0xff0000);
    defenders.push(db);
  }
}

function box(x,y,z,c){
  let m=new THREE.Mesh(
    new THREE.BoxGeometry(12,20,12),
    new THREE.MeshStandardMaterial({color:c})
  );
  m.position.set(x,y,z);
  scene.add(m);
  return m;
}

/* ===============================
   GAME LOGIC
================================ */
function snapBall(){
  state="PLAY";
  snapped=true;
  document.getElementById("playbook").style.display="none";
}

function throwBall(){
  if(ballVel.length()>0) return;
  ball.position.copy(qb.position);
  let dir=new THREE.Vector3(
    Math.sin(mouse.x),
    Math.sin(-mouse.y)+0.2,
    Math.cos(mouse.x)
  ).normalize();
  ballVel.copy(dir.multiplyScalar(500));
}

function updateRoutes(dt){
  receivers.forEach((wr,i)=>{
    if(!snapped) return;
    let s=120*dt;
    if(currentRoute===1){wr.position.x+=s;wr.position.z+=s*0.4;}
    if(currentRoute===2){wr.position.x+=s;}
    if(currentRoute===3){wr.position.x+=s;wr.position.z+=s;}
    if(currentRoute===4){wr.position.x+=s;wr.position.z-=s;}
  });
}

function updateDefense(dt){
  defenders.forEach(db=>{
    let t=receivers[0];
    let d=t.position.clone().sub(db.position).normalize();
    db.position.add(d.multiplyScalar(90*dt));
  });
}

/* ===============================
   UPDATE LOOP
================================ */
function animate(){
  requestAnimationFrame(animate);
  let dt=clock.getDelta();

  /* CAMERA ALWAYS */
  camera.position.lerp(
    new THREE.Vector3(
      qb.position.x-160,
      160,
      qb.position.z+260
    ),0.08
  );
  camera.lookAt(qb.position);

  if(state==="PLAY"){
    let speed=180*dt;
    if(keys["w"]) qb.position.x+=speed;
    if(keys["s"]) qb.position.x-=speed;
    if(keys["a"]) qb.position.z+=speed;
    if(keys["d"]) qb.position.z-=speed;
    if(keys[" "] ) throwBall();
  }

  updateRoutes(dt);
  updateDefense(dt);

  if(ballVel.length()>0){
    ball.position.add(ballVel.clone().multiplyScalar(dt));
    ballVel.y-=980*dt;
    if(ball.position.y<4){
      ballVel.set(0,0,0);
    }
  }

  renderer.render(scene,camera);
}

function addEndzone(x,color){
  let ez=new THREE.Mesh(
    new THREE.PlaneGeometry(200,800),
    new THREE.MeshStandardMaterial({color})
  );
  ez.rotation.x=-Math.PI/2;
  ez.position.x=x;
  scene.add(ez);
}
</script>
</body>
</html>
